var DashboardBullets={init:function(){!function(t,e){if("undefined"!=typeof d3){if($(t).length>0){!function(){function t(t){return t.ranges}function e(t){return t.markers}function r(t){return t.measures}function i(t){return function(e){return"translate("+t(e)+",0)"}}function l(t){var e=t(0);return function(r){return Math.abs(t(r)-e)}}d3.bullet=function(){var o="left",s=!1,u=750,d=t,c=e,h=r,f=30,g=null;function m(t){t.each(function(t,e){var r=d.call(this,t,e).slice().sort(d3.descending),o=c.call(this,t,e).slice().sort(d3.descending),m=h.call(this,t,e).slice().sort(d3.descending),p=d3.select(this),b=d3.scale.linear().domain([0,Math.max(r[0],o[0],m[0])]).range(s?[a,0]:[0,a]),y=this.__chart__||d3.scale.linear().domain([0,1/0]).range(b.range());this.__chart__=b;var x=l(y),v=l(b),w=p.selectAll(".bullet-range").data(r);w.enter().append("rect").attr("class",function(t,e){return"bullet-range bullet-range-"+(e+1)}).attr("width",x).attr("height",f).attr("rx",2).attr("x",s?y:0).transition().duration(u).attr("width",v).attr("x",s?b:0),w.transition().duration(u).attr("x",s?b:0).attr("width",v).attr("height",f);var k=p.selectAll(".bullet-measure").data(m);k.enter().append("rect").attr("class",function(t,e){return"bullet-measure bullet-measure-"+(e+1)}).attr("width",x).attr("height",f/5).attr("x",s?y:0).attr("y",f/2.5).style("shape-rendering","crispEdges"),k.transition().duration(u).attr("width",v).attr("x",s?b:0),k.transition().duration(u).attr("width",v).attr("height",f/5).attr("x",s?b:0).attr("y",f/2.5);var A=p.selectAll(".bullet-marker").data(o);A.enter().append("line").attr("class",function(t,e){return"bullet-marker bullet-marker-"+(e+1)}).attr("x1",y).attr("x2",y).attr("y1",f/6).attr("y2",5*f/6),A.transition().duration(u).attr("x1",b).attr("x2",b),A.transition().duration(u).attr("x1",b).attr("x2",b).attr("y1",f/6).attr("y2",5*f/6);var _=g||b.tickFormat(8),z=p.selectAll(".bullet-tick").data(b.ticks(8),function(t){return this.textContent||_(t)}),E=z.enter().append("g").attr("class","bullet-tick").attr("transform",i(y)).style("opacity",1e-6);E.append("line").attr("y1",f).attr("y2",7*f/6+3),E.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*f/6+4).text(_),E.transition().duration(u).attr("transform",i(b)).style("opacity",1);var B=z.transition().duration(u).attr("transform",i(b)).style("opacity",1);B.select("line").attr("y1",f+3).attr("y2",7*f/6+3),B.select("text").attr("y",7*f/6+4),z.exit().transition().duration(u).attr("transform",i(b)).style("opacity",1e-6).remove(),window.addEventListener("resize",C);var L=document.querySelector(".sidebar-control");function C(){a=d3.select("#bullets").node().getBoundingClientRect().width-n.left-n.right,v=l(b),b.range(s?[a,0]:[0,a]),p.selectAll(".bullet-measure").attr("width",v).attr("x",s?b:0),p.selectAll(".bullet-range").attr("width",v).attr("x",s?b:0),p.selectAll(".bullet-marker").attr("x1",b).attr("x2",b),p.selectAll(".bullet-tick").attr("transform",i(b))}L&&L.addEventListener("click",C)}),d3.timer.flush()}return m.orient=function(t){return arguments.length?(s="right"==(o=t)||"bottom"==o,m):o},m.ranges=function(t){return arguments.length?(d=t,m):d},m.markers=function(t){return arguments.length?(c=t,m):c},m.measures=function(t){return arguments.length?(h=t,m):h},m.width=function(t){return arguments.length?(a=t,m):a},m.height=function(t){return arguments.length?(f=t,m):f},m.tickFormat=function(t){return arguments.length?(g=t,m):g},m.duration=function(t){return arguments.length?(u=t,m):u},m}}();var r=d3.select(t),n={top:20,right:10,bottom:35,left:10},a=a=r.node().getBoundingClientRect().width-n.left-n.right,i=(e=e-n.top-n.bottom,d3.bullet().width(a).height(e));function l(t){return t.randomizer||(t.randomizer=function(t){var e=.2*d3.max(t.ranges);return function(t){return Math.max(0,t+e*(Math.random()-.5))}}(t)),t.ranges=t.ranges.map(t.randomizer),t.markers=t.markers.map(t.randomizer),t.measures=t.measures.map(t.randomizer),t}d3.json("../../../../global_assets/demo_data/dashboard/bullets.json",function(t,o){if(t)return console.error(t);var s=r.selectAll("svg").data(o).enter().append("svg"),u=s.attr("class",function(t,e){return"bullet-"+(e+1)}).attr("width",a+n.left+n.right).attr("height",e+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")").call(i),d=u.append("g").style("text-anchor","start");d.append("text").attr("class","bullet-title").attr("y",-10).text(function(t){return t.title}),d.append("text").attr("class","bullet-subtitle").attr("x",a).attr("y",-10).style("text-anchor","end").text(function(t){return t.subtitle}).style("opacity",0).transition().duration(500).delay(500).style("opacity",.75);var c=function(){u.datum(l).call(i.duration(750))},h=[];h.push(setInterval(function(){c()},5e3)),document.getElementById("realtime").onchange=function(){if(realtime.checked)h.push(setInterval(function(){c()},5e3));else for(var t=0;t<h.length;t++)clearInterval(h[t])},window.addEventListener("resize",g);var f=document.querySelector(".sidebar-control");function g(){a=r.node().getBoundingClientRect().width-n.left-n.right,s.attr("width",a+n.left+n.right),u.attr("width",a+n.left+n.right),u.selectAll(".bullet-subtitle").attr("x",a)}f&&f.addEventListener("click",g)})}}else console.warn("Warning - d3.min.js is not loaded.")}("#bullets",80)}};document.addEventListener("DOMContentLoaded",function(){DashboardBullets.init()});