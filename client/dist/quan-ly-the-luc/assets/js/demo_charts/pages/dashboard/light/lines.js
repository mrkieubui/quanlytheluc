var DashboardLines={init:function(){!function(t,e){if("undefined"!=typeof d3&&void 0!==d3.tip){if($(t).length>0){var n,a=d3.select(t),i={top:5,right:30,bottom:30,left:50},r=a.node().getBoundingClientRect().width-i.left-i.right,l=(e=e-i.top-i.bottom,d3.tip().attr("class","d3-tip").html(function(t){return'<ul class="list-unstyled mb-1"><li><div class="font-size-base my-1"><i class="icon-circle-left2 mr-2"></i>'+t.name+' app</div></li><li>Sales: &nbsp;<span class="font-weight-semibold float-right">'+t.value+'</span></li><li>Revenue: &nbsp; <span class="font-weight-semibold float-right">$'+(25*t.value).toFixed(2)+"</span></li></ul>"})),s=d3.time.format("%Y/%m/%d").parse,o=(d3.time.format("%b %d, %y"),d3.scale.ordinal().range(["#4CAF50","#FF5722","#5C6BC0"])),d=a.append("svg"),c=d.attr("width",r+i.left+i.right).attr("height",e+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")").call(l),u=document.getElementById("select_date");function f(){var t=d3.nest().key(function(t){return t.type}).map(formatted)[u.value];o.domain(d3.keys(t[0]).filter(function(t){return"date"!==t&&"type"!==t}));var n=o.domain().map(function(e){return{name:e,values:t.map(function(t){return{name:e,date:s(t.date),value:parseFloat(t[e],10)}})}}),f=d3.svg.line().x(function(t){return p(t.date)}).y(function(t){return h(t.value)}).interpolate("cardinal"),p=d3.time.scale().domain([d3.min(n,function(t){return d3.min(t.values,function(t){return t.date})}),d3.max(n,function(t){return d3.max(t.values,function(t){return t.date})})]).range([0,r]),h=d3.scale.linear().domain([d3.min(n,function(t){return d3.min(t.values,function(t){return t.value})}),d3.max(n,function(t){return d3.max(t.values,function(t){return t.value})})]).range([e,0]),m=d3.svg.axis().scale(p).orient("bottom").tickPadding(8).ticks(d3.time.days).innerTickSize(4).tickFormat(d3.time.format("%a")),g=d3.svg.axis().scale(h).orient("left").ticks(6).tickSize(0-r).tickPadding(8);c.append("g").attr("class","d3-axis d3-axis-horizontal").attr("transform","translate(0,"+e+")"),c.append("g").attr("class","d3-axis d3-axis-vertical d3-axis-transparent d3-grid d3-grid-dashed");var v=c.selectAll(".app-sales-lines").data(n);v.enter().append("g").attr("class","app-sales-lines").attr("id",function(t){return t.name+"-line"}).append("path").attr("class","d3-line d3-line-medium").style("stroke",function(t){return o(t.name)}).style("opacity",0).attr("d",function(t){return f(t.values[0])}).transition().duration(500).delay(function(t,e){return 200*e}).style("opacity",1);var y=v.selectAll("circle").data(function(t){return t.values}).enter().append("circle").attr("class","d3-line-circle d3-line-circle-medium").attr("cx",function(t,e){return p(t.date)}).attr("cy",function(t,e){return h(t.value)}).attr("r",3).style("stroke",function(t){return o(t.name)});y.style("opacity",0).transition().duration(500).delay(500).style("opacity",1),y.on("mouseover",function(t){l.offset([-15,0]).show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){l.hide(t),d3.select(this).transition().duration(250).attr("r",3)}),v.each(function(t){d3.select(d3.select(this).selectAll("circle")[0][0]).on("mouseover",function(t){l.offset([0,15]).direction("e").show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){l.direction("n").hide(t),d3.select(this).transition().duration(250).attr("r",3)})}),v.each(function(t){d3.select(d3.select(this).selectAll("circle")[0][d3.select(this).selectAll("circle").size()-1]).on("mouseover",function(t){l.offset([0,-15]).direction("w").show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){l.direction("n").hide(t),d3.select(this).transition().duration(250).attr("r",3)})});var w=d3.transition(v);w.select("path").attr("d",function(t,e){return f(t.values)}),w.selectAll("circle").attr("cy",function(t,e){return h(t.value)}).attr("cx",function(t,e){return p(t.date)}),d3.transition(c).select(".d3-axis-vertical").call(g),d3.transition(c).select(".d3-axis-horizontal").attr("transform","translate(0,"+e+")").call(m),window.addEventListener("resize",b);var x=document.querySelector(".sidebar-control");function b(){r=a.node().getBoundingClientRect().width-i.left-i.right,d.attr("width",r+i.left+i.right),c.attr("width",r+i.left+i.right),p.range([0,r]),h.range([e,0]),c.select(".d3-axis-horizontal").call(m),c.select(".d3-axis-vertical").call(g.tickSize(0-r)),c.selectAll(".d3-line").attr("d",function(t,e){return f(t.values)}),c.selectAll(".d3-line-circle").attr("cx",function(t,e){return p(t.date)})}x&&x.addEventListener("click",b)}u.addEventListener("change",function(){d3.transition().duration(n?7500:500).each(f)}),d3.csv("../../../../global_assets/demo_data/dashboard/app_sales.csv",function(t,e){formatted=e,f()}),d3.select(window).on("keydown",function(){n=d3.event.altKey}).on("keyup",function(){n=!1})}}else console.warn("Warning - d3.min.js is not loaded.")}("#app_sales",255),function(t,e){if("undefined"!=typeof d3){if($(t).length>0){var n=[{date:"04/13/14",alpha:"60"},{date:"04/14/14",alpha:"35"},{date:"04/15/14",alpha:"65"},{date:"04/16/14",alpha:"50"},{date:"04/17/14",alpha:"65"},{date:"04/18/14",alpha:"20"},{date:"04/19/14",alpha:"60"}],a=d3.select(t),i={top:0,right:0,bottom:0,left:0},r=a.node().getBoundingClientRect().width-i.left-i.right,l=(e=e-i.top-i.bottom,d3.time.format("%m/%d/%y").parse),s=d3.time.format("%a, %B %e"),o="#fff",d=d3.tip().attr("class","d3-tip").html(function(t){return'<ul class="list-unstyled mb-1"><li><div class="font-size-base my-1"><i class="icon-check2 mr-2"></i>'+s(t.date)+'</div></li><li>Sales: &nbsp;<span class="font-weight-semibold float-right">'+t.alpha+'</span></li><li>Revenue: &nbsp; <span class="font-weight-semibold float-right">$'+(25*t.alpha).toFixed(2)+"</span></li></ul>"}),c=a.append("svg"),u=c.attr("width",r+i.left+i.right).attr("height",e+i.top+i.bottom).append("g").attr("transform","translate("+i.left+","+i.top+")").call(d);n.forEach(function(t){t.date=l(t.date),t.alpha=+t.alpha});var f=d3.time.scale().range([20,r-20]),p=d3.scale.linear().range([e,5]);f.domain(d3.extent(n,function(t){return t.date})),p.domain([0,d3.max(n,function(t){return Math.max(t.alpha)})]);var h=d3.svg.line().x(function(t){return f(t.date)}).y(function(t){return p(t.alpha)}),m=u.append("defs").append("clipPath").attr("id","clip-line-small").append("rect").attr("class","clip").attr("width",0).attr("height",e);m.transition().duration(1e3).ease("linear").attr("width",r),u.append("path").attr({d:h(n),"clip-path":"url(#clip-line-small)",class:"d3-line d3-line-medium"}).style("stroke",o),u.select(".line-tickets").transition().duration(1e3).ease("linear");var g=u.append("g").selectAll(".d3-line-guides-group").data(n);g.enter().append("line").attr("class","d3-line-guides").attr("x1",function(t,e){return f(t.date)}).attr("y1",function(t,n){return e}).attr("x2",function(t,e){return f(t.date)}).attr("y2",function(t,n){return e}).style("stroke","rgba(255,255,255,0.3)").style("stroke-dasharray","4,2").style("shape-rendering","crispEdges"),g.transition().duration(1e3).delay(function(t,e){return 150*e}).attr("y2",function(t,e){return p(t.alpha)});var v=u.insert("g").selectAll(".d3-line-circle").data(n).enter().append("circle").attr("class","d3-line-circle d3-line-circle-medium").attr("cx",h.x()).attr("cy",h.y()).attr("r",3).style("stroke",o).style("fill",o);v.style("opacity",0).transition().duration(250).ease("linear").delay(1e3).style("opacity",1),v.on("mouseover",function(t){d.offset([-10,0]).show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){d.hide(t),d3.select(this).transition().duration(250).attr("r",3)}),d3.select(v[0][0]).on("mouseover",function(t){d.offset([0,10]).direction("e").show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){d.direction("n").hide(t),d3.select(this).transition().duration(250).attr("r",3)}),d3.select(v[0][v.size()-1]).on("mouseover",function(t){d.offset([0,-10]).direction("w").show(t),d3.select(this).transition().duration(250).attr("r",4)}).on("mouseout",function(t){d.direction("n").hide(t),d3.select(this).transition().duration(250).attr("r",3)}),window.addEventListener("resize",w);var y=document.querySelector(".sidebar-control");function w(){r=a.node().getBoundingClientRect().width-i.left-i.right,c.attr("width",r+i.left+i.right),u.attr("width",r+i.left+i.right),f.range([20,r-20]),m.attr("width",r),u.selectAll(".d3-line").attr("d",h(n)),u.selectAll(".d3-line-circle").attr("cx",h.x()),u.selectAll(".d3-line-guides").attr("x1",function(t,e){return f(t.date)}).attr("x2",function(t,e){return f(t.date)})}y&&y.addEventListener("click",w)}}else console.warn("Warning - d3.min.js is not loaded.")}("#today-revenue",50)}};document.addEventListener("DOMContentLoaded",function(){DashboardLines.init()});