(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty;!function(o){this.AddressPickerResult=function(){function e(e,t){this.placeResult=e,this.fromReverseGeocoding=null!=t&&t,this.latitude=this.placeResult.geometry.location.lat(),this.longitude=this.placeResult.geometry.location.lng()}return e.prototype.addressTypes=function(){var e,t,o,r,s,i,n,a;for(a=[],e=0,o=(s=this.addressComponents()).length;e<o;e++)for(t=0,r=(i=s[e].types).length;t<r;t++)-1===a.indexOf(n=i[t])&&a.push(n);return a},e.prototype.addressComponents=function(){return this.placeResult.address_components||[]},e.prototype.address=function(){return this.placeResult.formatted_address},e.prototype.nameForType=function(e,t){var o,r,s,i;for(null==t&&(t=!1),r=0,s=(i=this.addressComponents()).length;r<s;r++)if(-1!==(o=i[r]).types.indexOf(e))return t?o.short_name:o.long_name;return null},e.prototype.lat=function(){return this.latitude},e.prototype.lng=function(){return this.longitude},e.prototype.setLatLng=function(e,t){this.latitude=e,this.longitude=t},e.prototype.isAccurate=function(){return!this.placeResult.geometry.viewport},e.prototype.isReverseGeocoding=function(){return this.fromReverseGeocoding},e}(),this.AddressPicker=function(r){function s(t){null==t&&(t={}),this.markerDragged=e(this.markerDragged,this),this.updateBoundsForPlace=e(this.updateBoundsForPlace,this),this.updateMap=e(this.updateMap,this),this.options=o.extend({local:[],datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.num)},queryTokenizer:Bloodhound.tokenizers.whitespace,autocompleteService:{types:["geocode"]},zoomForLocation:16,reverseGeocoding:!1,placeDetails:!0,remote:"fakeRemote"},t),s.__super__.constructor.call(this,this.options),this.options.map&&this.initMap(),this.placeService=new google.maps.places.PlacesService(document.createElement("div"))}return function(e,o){for(var r in o)t.call(o,r)&&(e[r]=o[r]);function s(){this.constructor=e}s.prototype=o.prototype,e.prototype=new s,e.__super__=o.prototype}(s,Bloodhound),s.prototype.bindDefaultTypeaheadEvent=function(e){return e.bind("typeahead:selected",this.updateMap),e.bind("typeahead:autocompleted",this.updateMap),e.bind("typeahead:cursorchanged",this.updateMap)},s.prototype.initMap=function(){var e,t,r;if((null!=(t=this.options)&&null!=(r=t.map)?r.gmap:void 0)?this.map=this.options.map.gmap:(this.mapOptions=o.extend({zoom:3,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP,boundsForLocation:this.updateBoundsForPlace},this.options.map),this.map=new google.maps.Map(o(this.mapOptions.id)[0],this.mapOptions)),this.lastResult=null,e=o.extend({draggable:!0,visible:!1,position:this.map.getCenter(),map:this.map},this.options.marker||{}),this.marker=new google.maps.Marker(e),e.draggable)return google.maps.event.addListener(this.marker,"dragend",this.markerDragged)},s.prototype.search=function(e,t,r){var s,i;return s=new google.maps.places.AutocompleteService,this.options.autocompleteService.input=e,s.getPlacePredictions(this.options.autocompleteService,(i=this,function(e){return o(i).trigger("addresspicker:predictions",[e]),r(e)}))},s.prototype.updateMap=function(e,t){return this.options.placeDetails?this.placeService.getDetails(t,(r=this,function(e){var t;return r.lastResult=new AddressPickerResult(e),r.marker&&(r.marker.setPosition(e.geometry.location),r.marker.setVisible(!0)),r.map&&null!=(t=r.mapOptions)&&t.boundsForLocation(e),o(r).trigger("addresspicker:selected",r.lastResult)})):o(this).trigger("addresspicker:selected",t);var r},s.prototype.updateBoundsForPlace=function(e){return e.geometry.viewport?this.map.fitBounds(e.geometry.viewport):(this.map.setCenter(e.geometry.location),this.map.setZoom(this.options.zoomForLocation))},s.prototype.markerDragged=function(){return this.options.reverseGeocoding?this.reverseGeocode(this.marker.getPosition()):(this.lastResult?this.lastResult.setLatLng(this.marker.getPosition().lat(),this.marker.getPosition().lng()):this.lastResult=new AddressPickerResult({geometry:{location:this.marker.getPosition()}}),o(this).trigger("addresspicker:selected",this.lastResult))},s.prototype.reverseGeocode=function(e){return null==this.geocoder&&(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({location:e},(t=this,function(e){if(e&&e.length>0)return t.lastResult=new AddressPickerResult(e[0],!0),o(t).trigger("addresspicker:selected",t.lastResult)}));var t},s.prototype.getGMap=function(){return this.map},s.prototype.getGMarker=function(){return this.marker},s}()}(jQuery)}).call(this);