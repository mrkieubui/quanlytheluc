!function(r){"use strict";function e(r,a){var o=a.shift();if(null!==r){if(0===a.length)return r[o];if("object"==typeof r)return e(r[o],a)}return r}var a={serverPath:"",fileFieldName:"fileToUpload",data:[],headers:{},xhrFields:{},urlPropertyName:"file",statusPropertyName:"success",success:void 0,error:void 0,imageWidthModalEdit:!1};(function(){if(!r.trumbowyg.addedXhrProgressEvent){var e=r.ajaxSettings.xhr;r.ajaxSetup({xhr:function(){var r=this,a=e();return a&&"object"==typeof a.upload&&void 0!==r.progressUpload&&a.upload.addEventListener("progress",function(e){r.progressUpload(e)},!1),a}}),r.trumbowyg.addedXhrProgressEvent=!0}})(),r.extend(!0,r.trumbowyg,{langs:{en:{upload:"Upload",file:"File",uploadError:"Error"},da:{upload:"Upload",file:"Fil",uploadError:"Fejl"},de:{upload:"Hochladen",file:"Datei",uploadError:"Fehler"},sk:{upload:"Nahra\u0165",file:"S\xfabor",uploadError:"Chyba"},fr:{upload:"Envoi",file:"Fichier",uploadError:"Erreur"},cs:{upload:"Nahr\xe1t obr\xe1zek",file:"Soubor",uploadError:"Chyba"},zh_cn:{upload:"\u4e0a\u4f20",file:"\u6587\u4ef6",uploadError:"\u9519\u8bef"},zh_tw:{upload:"\u4e0a\u50b3",file:"\u6587\u4ef6",uploadError:"\u932f\u8aa4"},ru:{upload:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430",file:"\u0424\u0430\u0439\u043b",uploadError:"\u041e\u0448\u0438\u0431\u043a\u0430"},ja:{upload:"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9",file:"\u30d5\u30a1\u30a4\u30eb",uploadError:"\u30a8\u30e9\u30fc"},pt_br:{upload:"Enviar do local",file:"Arquivo",uploadError:"Erro"},tr:{upload:"Y\xfckle",file:"Dosya",uploadError:"Hata"},ko:{upload:"\uadf8\ub9bc \uc62c\ub9ac\uae30",file:"\ud30c\uc77c",uploadError:"\uc5d0\ub7ec"}},plugins:{upload:{init:function(o){o.o.plugins.upload=r.extend(!0,{},a,o.o.plugins.upload||{});var l={fn:function(){o.saveRange();var a,l=o.o.prefix,t={file:{type:"file",required:!0,attributes:{accept:"image/*"}},alt:{label:"description",value:o.getRangeText()}};o.o.plugins.upload.imageWidthModalEdit&&(t.width={value:""});var d=o.openModalInsert(o.lang.upload,t,function(t){var i=new FormData;i.append(o.o.plugins.upload.fileFieldName,a),o.o.plugins.upload.data.map(function(r){i.append(r.name,r.value)}),r.map(t,function(r,e){"file"!==e&&i.append(e,r)}),0===r("."+l+"progress",d).length&&r("."+l+"modal-title",d).after(r("<div/>",{class:l+"progress"}).append(r("<div/>",{class:l+"progress-bar"}))),r.ajax({url:o.o.plugins.upload.serverPath,headers:o.o.plugins.upload.headers,xhrFields:o.o.plugins.upload.xhrFields,type:"POST",data:i,cache:!1,dataType:"json",processData:!1,contentType:!1,progressUpload:function(e){r("."+l+"progress-bar").css("width",Math.round(100*e.loaded/e.total)+"%")},success:function(a){if(o.o.plugins.upload.success)o.o.plugins.upload.success(a,o,d,t);else if(e(a,o.o.plugins.upload.statusPropertyName.split("."))){var l=e(a,o.o.plugins.upload.urlPropertyName.split("."));o.execCmd("insertImage",l,!1,!0);var i=r('img[src="'+l+'"]:not([alt])',o.$box);i.attr("alt",t.alt),o.o.imageWidthModalEdit&&parseInt(t.width)>0&&i.attr({width:t.width}),setTimeout(function(){o.closeModal()},250),o.$c.trigger("tbwuploadsuccess",[o,a,l])}else o.addErrorOnModalField(r("input[type=file]",d),o.lang[a.message]),o.$c.trigger("tbwuploaderror",[o,a])},error:o.o.plugins.upload.error||function(){o.addErrorOnModalField(r("input[type=file]",d),o.lang.uploadError),o.$c.trigger("tbwuploaderror",[o])}})});r("input[type=file]").on("change",function(r){try{a=r.target.files[0]}catch(e){a=r.target.value}})}};o.addBtnDef("upload",l)}}}})}(jQuery);