!function(l,a){function e(l){return a.translate(l)||l}var t={};l.fn.pluploadQueue=function(d){return d?(this.each(function(){function s(e){var t;e.status==a.DONE&&(t="plupload_done"),e.status==a.FAILED&&(t="plupload_failed"),e.status==a.QUEUED&&(t="plupload_delete"),e.status==a.UPLOADING&&(t="plupload_uploading");var d=l("#"+e.id).attr("class",t).find("a").css("display","block");e.hint&&d.attr("title",e.hint)}function i(){l("span.plupload_total_status",u).html(n.total.percent+"%"),l("div.plupload_progress_bar",u).css("width",n.total.percent+"%"),l("span.plupload_upload_status",u).html(a.sprintf(e("Uploaded %d/%d files"),n.total.uploaded,n.files.length))}function p(){var t,d=l("ul.plupload_filelist",u).html(""),p=0;l.each(n.files,function(e,i){t="",i.status==a.DONE&&(i.target_name&&(t+='<input type="hidden" name="'+_+"_"+p+'_tmpname" value="'+a.xmlEncode(i.target_name)+'" />'),t+='<input type="hidden" name="'+_+"_"+p+'_name" value="'+a.xmlEncode(i.name)+'" />',t+='<input type="hidden" name="'+_+"_"+p+'_status" value="'+(i.status==a.DONE?"done":"failed")+'" />',p++,l("#"+_+"_count").val(p)),d.append('<li id="'+i.id+'"><div class="plupload_file_name"><span>'+i.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+i.percent+'%</div><div class="plupload_file_size">'+a.formatSize(i.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+t+"</li>"),s(i),l("#"+i.id+".plupload_delete a").click(function(a){l("#"+i.id).remove(),n.removeFile(i),a.preventDefault()})}),l("span.plupload_total_file_size",u).html(a.formatSize(n.total.size)),0===n.total.queued?l("span.plupload_add_text",u).html(e("Add Files")):l("span.plupload_add_text",u).html(a.sprintf(e("%d files queued"),n.total.queued)),l("a.plupload_start",u).toggleClass("plupload_disabled",n.files.length==n.total.uploaded+n.total.failed),d[0].scrollTop=d[0].scrollHeight,i(),!n.files.length&&n.features.dragdrop&&n.settings.dragdrop&&l("#"+_+"_filelist").append('<li class="plupload_droptext">'+e("Drag files here.")+"</li>")}function o(){delete t[_],n.destroy(),u.html(r),n=u=r=null}var n,u,_,r;u=l(this),(_=u.attr("id"))||(_=a.guid(),u.attr("id",_)),r=u.html(),function(a,t){t.contents().each(function(a,e){(e=l(e)).is(".plupload")||e.remove()}),t.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+e("Select files")+'</div><div class="plupload_header_text">'+e("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+e("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+e("Status")+'</span></div><div class="plupload_file_size">'+e("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+a+'_browse">'+e("Add Files")+'</a><a href="#" class="plupload_button plupload_start">'+e("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+a+'_count" name="'+a+'_count" value="0" /></div>')}(_,u),(d=l.extend({dragdrop:!0,browse_button:_+"_browse",container:_},d)).dragdrop&&(d.drop_element=_+"_filelist"),n=new a.Uploader(d),t[_]=n,n.bind("UploadFile",function(a,e){l("#"+e.id).addClass("plupload_current_file")}),n.bind("Init",function(a,e){!d.unique_names&&d.rename&&u.on("click","#"+_+"_filelist div.plupload_file_name span",function(e){var t,d,s,i=l(e.target),p="";i.closest("li").hasClass("plupload_delete")&&(t=a.getFile(i.parents("li")[0].id),(d=/^(.+)(\.[^.]+)$/.exec(s=t.name))&&(s=d[1],p=d[2]),i.hide().after('<input type="text" />'),i.next().val(s).focus().blur(function(){i.show().next().remove()}).keydown(function(a){var e=l(this);13==a.keyCode&&(a.preventDefault(),t.name=e.val()+p,i.html(t.name),e.blur())}))}),l("#"+_+"_container").attr("title","Using runtime: "+e.runtime),l("a.plupload_start",u).click(function(a){l(this).hasClass("plupload_disabled")||n.start(),a.preventDefault()}),l("a.plupload_stop",u).click(function(l){l.preventDefault(),n.stop()}),l("a.plupload_start",u).addClass("plupload_disabled")}),n.bind("Error",function(t,d){var s,i=d.file;i&&(s=d.message,d.details&&(s+=" ("+d.details+")"),d.code==a.FILE_SIZE_ERROR&&alert(e("Error: File too large:")+" "+i.name),d.code==a.FILE_EXTENSION_ERROR&&alert(e("Error: Invalid file extension:")+" "+i.name),i.hint=s,l("#"+i.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",s)),d.code===a.INIT_ERROR&&setTimeout(function(){o()},1)}),n.bind("PostInit",function(a){a.settings.dragdrop&&a.features.dragdrop&&l("#"+_+"_filelist").append('<li class="plupload_droptext">'+e("Drag files here.")+"</li>")}),n.init(),n.bind("StateChanged",function(){n.state===a.STARTED?(l("li.plupload_delete a,div.plupload_buttons",u).hide(),n.disableBrowse(!0),l("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",u).css("display","block"),l("span.plupload_upload_status",u).html("Uploaded "+n.total.uploaded+"/"+n.files.length+" files"),d.multiple_queues&&l("span.plupload_total_status,span.plupload_total_file_size",u).show()):(p(),l("a.plupload_stop,div.plupload_progress",u).hide(),l("a.plupload_delete",u).css("display","block"),d.multiple_queues&&n.total.uploaded+n.total.failed==n.files.length&&(l(".plupload_buttons,.plupload_upload_status",u).css("display","inline"),n.disableBrowse(!1),l(".plupload_start",u).addClass("plupload_disabled"),l("span.plupload_total_status,span.plupload_total_file_size",u).hide()))}),n.bind("FilesAdded",p),n.bind("FilesRemoved",function(){var a=l("#"+_+"_filelist").scrollTop();p(),l("#"+_+"_filelist").scrollTop(a)}),n.bind("FileUploaded",function(l,a){s(a)}),n.bind("UploadProgress",function(a,e){l("#"+e.id+" div.plupload_file_status",u).html(e.percent+"%"),s(e),i()}),d.setup&&d.setup(n)}),this):t[l(this[0]).attr("id")]}}(jQuery,plupload);